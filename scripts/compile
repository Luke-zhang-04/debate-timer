#!/bin/sh

./node_modules/.bin/tsc -p . || exit 1 &
./node_modules/.bin/tsc -p tsconfig.cli.json || exit 1 &

wait

./node_modules/.bin/rollup -c || exit 1

./node_modules/.bin/babel bot.js -o bot.js || exit 1 &
./node_modules/.bin/babel cli/index.js -o cli/index.js || exit 1 &

wait

echo "#!/bin/node
/**
 * Discord Debate Timer
 * @copyright 2020 Luke Zhang
 * @author Luke Zhang luke-zhang-04.github.io/
 * @version 1.3.0
 * @license BSD-3-Clause
 */
$(cat bot.js)" > bot.js

chmod +x bot.js
